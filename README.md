# Confined Migration Induces Heterochromatin Formation and Alters Chromatin Accessibility

Chieh-Ren Hsia<sup>1,2</sup>, Jawuanna McAllister<sup>1,2</sup>, Ovais Hasan<sup>2</sup>, Julius Judd<sup>1</sup>, Seoyeon Lee<sup>3,4</sup>, Richa Agrawal<sup>1,2</sup>, Chao-Yuan Chang<sup>2,5</sup>, Paul Soloway<sup>3,4</sup>, Jan Lammerding<sup>2,5*</sup>

<sup>1</sup>Department of Molecular Biology and Genetics, Cornell University, Ithaca, NY, USA  
<sup>2</sup>Weill Institute for Cell and Molecular Biology, Cornell University, Ithaca, NY, USA  
<sup>3</sup>Department of Biomedical Sciences, Cornell University, Ithaca, NY, USA  
<sup>4</sup>Division of Nutritional Sciences, Cornell University, Ithaca, NY, USA  
<sup>5</sup>Nancy E. and Peter C. Meinig School of Biomedical Engineering, Cornell University, Ithaca, NY, USA   
  
This repository contains R code used to analyze ATAC-seq data presented in the above manuscript.  Data was processed as follows (excerpted from the methods section of the paper):
  
ATAC-seq data quality was assessed with fastqc. Adapter sequences were trimmed using fastp. Reads were aligned to the hg38 reference genome assembly using bowtie2 in sensitive-local mode. Alignments were filtered to remove reads with multiple valid alignments (mapq > 1). Coverage signal tracks were generated using deepTools bamCoverage and normalized on a per-million basis. Peaks were called using macs2 with default settings, pooling all datasets as input, using a minimum -log10 q-value threshold of 100. Reads mapping within peaks were counted using featureCounts, and differential accessibility was determined using DESeq2, considering peaks with adjusted p-values lower than 0.1 as significantly differentially accessible. All DESeq2 comparisons were performed using the full matrix of high, medium, and low concentration collagen ATAC-seq scores, so pairwise comparisons were assessed for significance in the context of global variation across all three conditions. HOMER (Hypergeometric Optimization of Motif EnRichment) was used for annotation of DA peaks. Metaprofiles were generated using the BRGenomics R package, and are representative of average and 75% confidence interval over indicated sets of peaks calculated by subsampling 10% of peaks 1,000 times. Peaks that overlap with the region from -1,000 to transcription start site (TSS) of any annotated transcript in the hg38 genome assembly were considered promoter-associated, and all other peaks were considered non-promoter-associated. All promoter-associated peaks with the nearest non-promoter-associated peaks closer than 500 kb were considered enhancer-promoter interactions (EPI). Enrichment of transposable element (TE) overlaps with the DA peaks was performed using the script TE-anaysis_Shuffle_bed.pl (https://github.com/4ureliek/TEanalysis).

The folder "image_j_macros" contains ImageJ macros used in the manuscript and was duplicated from https://github.com/chiehrenhsia/ConfinedMigration 

To quantify normalized heterochromatin values, nuclear areas were selected by thresholding using the median-filtered DAPI channel. Mean grey intensity of the heterochromatin mark (H3K9me3 or H3K27me3) and the euchromatin mark (H3K9ac) were quantified, and the heterochromatin intensity was divided by the euchromatin intensity to obtain normalized heterochromatin values. Apoptotic fragments and overlapped nuclei were manually excluded from the dataset. Experiments with high variability of cell seeding between control and experimental groups were excluded. For all other quantification of staining intensities, nuclear areas were selected by thresholding using the median-filtered DAPI channel (or comparable nuclear signal when DAPI was not available), and mean grey intensities of channels of interests were quantified. All staining thresholding and quantification were performed through custom ImageJ Macros to ensure consistency and reproducibility. For generation of normalized heterochromatin images, the heterochromatin mark channel (H3K9me3 or H3K27me3) was divided by the euchromatin mark (H3K9ac) channel using the “image calculator” function in ImageJ. In the euchromatin (H3K9ac) channel, pixels with 0 value were converted to 1 to ensure division without errors. The normalized image was then median-filtered and a nuclear mask of median-filtered DAPI channel was applied to exclude artifacts of non-nuclear background noise. 


